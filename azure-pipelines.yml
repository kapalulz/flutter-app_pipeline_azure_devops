# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- git branch: 'main', credentialsId: 'ssss', url: 'git@github.com:kapalulz/upwork.git'

- script: |
    sh 'flutter test'
    
- script: |           
     sh '''
     #!/bin/sh
     flutter build apk --debug
        '''
  
   stage('DISTRIBUTE') {
            steps {
                appCenter apiToken: '09dbebbcc47c6059225a410556bb0e6c7e82b37c',
                        ownerName: 'kapalulz',
                        appName: 'myapp',
                        pathToApp: 'build/app/outputs/flutter-apk/app-debug.apk', 
                        distributionGroups: 'Beta Tester'
            }
        }
    }
}